@page "/login"
@namespace LoginComponent2

@using LoginExample.Authentication

@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager



<AuthorizeView>
    <NotAuthorized>
        
        
        <div class="p-3 mb-2 bg-light text-dark text-center card">
            <h3>Adult database login</h3>
            <div class="form-group">
                <input class="form-control" type="text" placeholder="Username" @bind-value="username"/>
            </div>
            <div class="form-group">
                <input class="form-control" type="password" placeholder="Password" @bind-value="password"/>
            </div>
            <div style="color:red">@errorMessage</div>

            <a class="btn btn-primary" @onclick="PerformLogin">
                <em class="text-light">Login</em>
            </a>

        </div>
    </NotAuthorized>
    <Authorized>
        <h1>Succes!</h1>
    </Authorized>
</AuthorizeView>



@code {
private string username;
private string password;
private string errorMessage;

public async Task PerformLogin() {
    errorMessage = "";
    try {
        ((CustomAuthenticationStateProvider) AuthenticationStateProvider).ValidateLogin(username, password);
        username = "";
        password = "";
    } catch (Exception e) {
        errorMessage = e.Message;
    }
}

public async Task PerformLogout() {
errorMessage = "";
username = "";
password = "";
try {
((CustomAuthenticationStateProvider) AuthenticationStateProvider).Logout();
NavigationManager.NavigateTo("/");
} catch (Exception e) { }
}

}